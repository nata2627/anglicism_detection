"""
Словарь часто встречающихся именованных сущностей,
которые могут быть не распознаны Natasha
"""
import re
COMMON_NAMED_ENTITIES = {
    # Страны и регионы
    'сша', 'америка', 'американский', 'американская', 'российская', 'российский',
    'россия', 'рф', 'китай', 'япония', 'европа', 'европейский', 'европейская',
    'украина', 'украинский', 'украинская', 'белоруссия', 'беларусь',
    'германия', 'немецкий', 'немецкая', 'турция', 'турецкий', 'турецкая',
    'франция', 'французский', 'французская', 'великобритания', 'британский', 'британская',
    'английский', 'английская', 'канада', 'канадский', 'канадская',
    'италия', 'итальянский', 'итальянская', 'испания', 'испанский', 'испанская',
    'азия', 'азиатский', 'азиатская', 'африка', 'африканский', 'африканская',

    # Города
    'москва', 'московский', 'московская', 'петербург', 'петербургский',
    'вашингтон', 'нью-йорк', 'лондон', 'лондонский', 'париж', 'парижский',
    'берлин', 'пекин', 'токио', 'киев', 'киевский', 'минск', 'минский',

    # Политические деятели
    'путин', 'трамп', 'байден', 'обама', 'медведев', 'шойгу', 'лавров',
    'зеленский', 'лукашенко', 'меркель', 'макрон', 'джонсон', 'сунак',
    'си', 'цзиньпин', 'абэ', 'эрдоган', 'нетаньяху',

    # Имена
    'владимир', 'дональд', 'джо', 'барак', 'дмитрий', 'сергей', 'виктор',
    'ангела', 'эммануэль', 'борис', 'реджеп', 'биньямин', 'тайип',
    'джозеф', 'камала', 'харрис', 'байден', 'трамп', 'олаф', 'шольц',

    # Организации
    'оон', 'юнеско', 'нато', 'ес', 'евросоюз', 'совбез', 'мид', 'минфин',
    'минобороны', 'госдеп', 'фбр', 'цру', 'мвф', 'всемирный', 'госдума',
    'рбк', 'кремль', 'белый', 'дом', 'пентагон', 'газпром', 'роснефть',
    'сбербанк', 'втб', 'яндекс', 'гугл', 'google', 'apple', 'tesla', 'мета',
    'фейсбук', 'facebook', 'твиттер', 'twitter', 'инстаграм', 'instagram',

    # Другие часто встречающиеся
    'covid', 'ковид', 'коронавирус', 'пандемия',
}


def extend_named_entities(entities, text_lower):
    """
    Расширяет список сущностей, найденных Natasha, добавляя
    часто встречающиеся именованные сущности из словаря.

    Args:
        entities: Множество сущностей, найденных Natasha
        text_lower: Текст в нижнем регистре для поиска дополнительных сущностей

    Returns:
        Set[str]: Расширенное множество сущностей
    """
    # Добавляем из словаря только те сущности, которые действительно есть в тексте
    extended_entities = set(entities)

    for entity in COMMON_NAMED_ENTITIES:
        # Проверяем наличие сущности как отдельного слова с помощью регулярного выражения
        if re.search(r'\b' + re.escape(entity) + r'\b', text_lower):
            extended_entities.add(entity)

    return extended_entities